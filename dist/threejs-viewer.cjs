"use strict";var ge=Object.defineProperty;var we=(n,e,r)=>e in n?ge(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r;var a=(n,e,r)=>we(n,typeof e!="symbol"?e+"":e,r);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const be=require("three"),ae=require("three-stdlib"),l=require("react");function Ee(n){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(n){for(const r in n)if(r!=="default"){const s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(e,r,s.get?s:{enumerable:!0,get:()=>n[r]})}}return e.default=n,Object.freeze(e)}const f=Ee(be);class oe{constructor(){a(this,"_scene");a(this,"_isDisposed",!1);this._scene=new f.Scene}get scene(){return this._scene}add(e){if(this._isDisposed)throw new Error("SceneManager has been disposed");this._scene.add(e)}remove(e){if(this._isDisposed)throw new Error("SceneManager has been disposed");this._scene.remove(e)}clear(){if(this._isDisposed)throw new Error("SceneManager has been disposed");for(;this._scene.children.length>0;){const e=this._scene.children[0];e&&(this._disposeObject(e),this._scene.remove(e))}}dispose(){this._isDisposed||(this.clear(),this._scene.background&&(this._scene.background instanceof f.Texture&&this._scene.background.dispose(),this._scene.background=null),this._scene.environment&&(this._scene.environment.dispose(),this._scene.environment=null),this._isDisposed=!0)}_disposeObject(e){for(;e.children.length>0;){const r=e.children[0];r&&(this._disposeObject(r),e.remove(r))}e instanceof f.Mesh&&(e.geometry&&e.geometry.dispose(),e.material&&this._disposeMaterial(e.material)),(e instanceof f.Line||e instanceof f.Points)&&(e.geometry&&e.geometry.dispose(),e.material&&this._disposeMaterial(e.material))}_disposeMaterial(e){Array.isArray(e)?e.forEach(r=>this._disposeSingleMaterial(r)):this._disposeSingleMaterial(e)}_disposeSingleMaterial(e){["map","lightMap","bumpMap","normalMap","specularMap","envMap","alphaMap","aoMap","displacementMap","emissiveMap","gradientMap","metalnessMap","roughnessMap"].forEach(s=>{const i=e[s];i instanceof f.Texture&&i.dispose()}),e.dispose()}}const W={fov:75,near:.1,far:1e3,position:new f.Vector3(0,0,5)};class le{constructor(e){a(this,"_camera");a(this,"_isDisposed",!1);const r=(e==null?void 0:e.fov)??W.fov,s=(e==null?void 0:e.near)??W.near,i=(e==null?void 0:e.far)??W.far,c=(e==null?void 0:e.position)??W.position.clone();this._camera=new f.PerspectiveCamera(r,1,s,i),this._camera.position.copy(c)}get camera(){return this._camera}configure(e){if(this._isDisposed)throw new Error("CameraManager has been disposed");e.fov!==void 0&&(this._camera.fov=e.fov),e.near!==void 0&&(this._camera.near=e.near),e.far!==void 0&&(this._camera.far=e.far),e.position!==void 0&&this._camera.position.copy(e.position),this._camera.updateProjectionMatrix()}setAspect(e){if(this._isDisposed)throw new Error("CameraManager has been disposed");(e<=0||!Number.isFinite(e))&&(console.warn("CameraManager: Invalid aspect ratio provided, using 1"),e=1),this._camera.aspect=e,this._camera.updateProjectionMatrix()}lookAt(e){if(this._isDisposed)throw new Error("CameraManager has been disposed");this._camera.lookAt(e)}dispose(){this._isDisposed||(this._isDisposed=!0)}}const re={antialias:!0,alpha:!1};class ce{constructor(){a(this,"_renderer",null);a(this,"_container",null);a(this,"_isDisposed",!1);a(this,"_isInitialized",!1)}get renderer(){if(!this._renderer)throw new Error("RenderManager has not been initialized. Call initialize() first.");return this._renderer}initialize(e,r){if(this._isDisposed)throw new Error("RenderManager has been disposed");if(this._isInitialized)throw new Error("RenderManager has already been initialized");const s=(r==null?void 0:r.antialias)??re.antialias,i=(r==null?void 0:r.alpha)??re.alpha;this._renderer=new f.WebGLRenderer({antialias:s,alpha:i}),this._renderer.setPixelRatio(window.devicePixelRatio);const c=e.clientWidth||1,d=e.clientHeight||1;this._renderer.setSize(c,d),e.appendChild(this._renderer.domElement),this._container=e,this._isInitialized=!0}setSize(e,r){if(this._isDisposed)throw new Error("RenderManager has been disposed");if(!this._renderer)throw new Error("RenderManager has not been initialized. Call initialize() first.");const s=Math.max(1,Math.floor(e)),i=Math.max(1,Math.floor(r));this._renderer.setSize(s,i)}render(e,r){if(this._isDisposed)throw new Error("RenderManager has been disposed");if(!this._renderer)throw new Error("RenderManager has not been initialized. Call initialize() first.");this._renderer.render(e,r)}dispose(){this._isDisposed||(this._renderer&&(this._container&&this._renderer.domElement.parentElement===this._container&&this._container.removeChild(this._renderer.domElement),this._renderer.dispose(),this._renderer=null),this._container=null,this._isInitialized=!1,this._isDisposed=!0)}}class ue{constructor(){a(this,"_plugins",new Map);a(this,"_context",null);a(this,"_isDisposed",!1)}setContext(e){if(this._isDisposed)throw new Error("PluginSystem has been disposed");this._context=e}getContext(){return this._context}register(e){if(this._isDisposed)throw new Error("PluginSystem has been disposed");if(!this._context)throw new Error("Plugin context has not been set. Call setContext() before registering plugins.");if(this._plugins.has(e.name))throw new Error(`Plugin "${e.name}" is already registered`);e.initialize(this._context),this._plugins.set(e.name,e)}unregister(e){if(this._isDisposed)throw new Error("PluginSystem has been disposed");const r=this._plugins.get(e);r&&(r.dispose(),this._plugins.delete(e))}get(e){return this._plugins.get(e)}has(e){return this._plugins.has(e)}getPluginNames(){return Array.from(this._plugins.keys())}get pluginCount(){return this._plugins.size}updateAll(e){if(this._isDisposed)throw new Error("PluginSystem has been disposed");for(const r of this._plugins.values())if(r.update)try{r.update(e)}catch(s){console.error(`Error updating plugin "${r.name}":`,s)}}disposeAll(){if(!this._isDisposed){for(const e of this._plugins.values())try{e.dispose()}catch(r){console.error(`Error disposing plugin "${e.name}":`,r)}this._plugins.clear(),this._context=null,this._isDisposed=!0}}}class de{constructor(){a(this,"_sceneManager");a(this,"_cameraManager");a(this,"_renderManager");a(this,"_pluginSystem");a(this,"_container",null);a(this,"_isInitialized",!1);a(this,"_isRunning",!1);a(this,"_isDisposed",!1);a(this,"_animationFrameId",null);a(this,"_lastTime",0);a(this,"_renderLoop",()=>{if(!this._isRunning||this._isDisposed)return;const e=performance.now(),r=(e-this._lastTime)/1e3;this._lastTime=e,this._pluginSystem.updateAll(r),this._renderManager.render(this._sceneManager.scene,this._cameraManager.camera),this._animationFrameId=requestAnimationFrame(this._renderLoop)});this._sceneManager=new oe,this._cameraManager=new le,this._renderManager=new ce,this._pluginSystem=new ue}get scene(){return this._sceneManager}get camera(){return this._cameraManager}get renderer(){return this._renderManager}get plugins(){return this._pluginSystem}get isRunning(){return this._isRunning}get isInitialized(){return this._isInitialized}get container(){return this._container}initialize(e){if(this._isDisposed)throw new Error("ViewerCore has been disposed");if(this._isInitialized)throw new Error("ViewerCore has already been initialized");const{container:r,antialias:s,alpha:i,cameraConfig:c}=e;this._container=r,c&&this._cameraManager.configure(c);const d={};s!==void 0&&(d.antialias=s),i!==void 0&&(d.alpha=i),this._renderManager.initialize(r,d);const w=r.clientWidth||1,x=r.clientHeight||1;this._cameraManager.setAspect(w/x);const g={scene:this._sceneManager.scene,camera:this._cameraManager.camera,renderer:this._renderManager.renderer,container:r};this._pluginSystem.setContext(g),this._isInitialized=!0}start(){if(this._isDisposed)throw new Error("ViewerCore has been disposed");if(!this._isInitialized)throw new Error("ViewerCore has not been initialized. Call initialize() first.");this._isRunning||(this._isRunning=!0,this._lastTime=performance.now(),this._renderLoop())}stop(){if(this._isDisposed)throw new Error("ViewerCore has been disposed");this._isRunning=!1,this._animationFrameId!==null&&(cancelAnimationFrame(this._animationFrameId),this._animationFrameId=null)}resize(e,r){if(this._isDisposed)throw new Error("ViewerCore has been disposed");if(!this._isInitialized)throw new Error("ViewerCore has not been initialized. Call initialize() first.");const s=Math.max(1,e),i=Math.max(1,r);this._cameraManager.setAspect(s/i),this._renderManager.setSize(s,i)}dispose(){this._isDisposed||(this.stop(),this._pluginSystem.disposeAll(),this._renderManager.dispose(),this._sceneManager.dispose(),this._cameraManager.dispose(),this._container=null,this._isInitialized=!1,this._isDisposed=!0)}}class he{constructor(){a(this,"name","ModelLoaderPlugin");a(this,"_context",null);a(this,"_loader");a(this,"_currentModel",null);a(this,"_boundingBox",null);a(this,"_center",null);a(this,"_loadingState",{isLoading:!1,progress:0,error:null});a(this,"_isDisposed",!1);this._loader=new ae.GLTFLoader}get loadingState(){return{...this._loadingState}}initialize(e){if(this._isDisposed)throw new Error("ModelLoaderPlugin has been disposed");this._context=e}async load(e){if(this._isDisposed)throw new Error("ModelLoaderPlugin has been disposed");if(!this._context)throw new Error("ModelLoaderPlugin has not been initialized. Call initialize() first.");this._currentModel&&this.unload(),this._loadingState={isLoading:!0,progress:0,error:null};try{const s=(await this._loadGLTF(e)).scene;this._context.scene.add(s),this._currentModel=s;const i=new f.Box3().setFromObject(s),c=new f.Vector3;return i.getCenter(c),this._boundingBox=i,this._center=c,this._loadingState={isLoading:!1,progress:100,error:null},{model:s,boundingBox:i,center:c}}catch(r){const s=r instanceof Error?r:new Error(`Failed to load model from URL: ${e}`);throw this._loadingState={isLoading:!1,progress:0,error:s},s}}unload(){this._currentModel&&this._context&&(this._context.scene.remove(this._currentModel),this._disposeObject(this._currentModel),this._currentModel=null,this._boundingBox=null,this._center=null)}getCenter(){return this._center?this._center.clone():null}getBoundingBox(){return this._boundingBox?this._boundingBox.clone():null}dispose(){this._isDisposed||(this.unload(),this._context=null,this._isDisposed=!0)}_loadGLTF(e){return new Promise((r,s)=>{this._loader.load(e,i=>{r(i)},i=>{if(i.lengthComputable){const c=i.loaded/i.total*100;this._loadingState={...this._loadingState,progress:Math.round(c)}}},i=>{const c=i instanceof Error?i.message:`Failed to load model from URL: ${e}`;s(new Error(c))})})}_disposeObject(e){for(;e.children.length>0;){const r=e.children[0];r&&(this._disposeObject(r),e.remove(r))}e instanceof f.Mesh&&(e.geometry&&e.geometry.dispose(),e.material&&this._disposeMaterial(e.material)),(e instanceof f.Line||e instanceof f.Points)&&(e.geometry&&e.geometry.dispose(),e.material&&this._disposeMaterial(e.material)),e instanceof f.SkinnedMesh&&e.skeleton&&e.skeleton.dispose()}_disposeMaterial(e){Array.isArray(e)?e.forEach(r=>this._disposeSingleMaterial(r)):this._disposeSingleMaterial(e)}_disposeSingleMaterial(e){["map","lightMap","bumpMap","normalMap","specularMap","envMap","alphaMap","aoMap","displacementMap","emissiveMap","gradientMap","metalnessMap","roughnessMap","clearcoatMap","clearcoatNormalMap","clearcoatRoughnessMap","transmissionMap","thicknessMap","sheenColorMap","sheenRoughnessMap"].forEach(s=>{const i=e[s];i instanceof f.Texture&&i.dispose()}),e.dispose()}}class _e{constructor(){a(this,"name","OrbitControlsPlugin");a(this,"_context",null);a(this,"_controls",null);a(this,"_isDisposed",!1);a(this,"_initialTarget",new f.Vector3(0,0,0));a(this,"_initialCameraPosition",new f.Vector3(0,0,5));a(this,"_initialMinDistance",.1);a(this,"_initialMaxDistance",1e3)}get controls(){if(!this._controls)throw new Error("OrbitControlsPlugin has not been initialized. Call initialize() first.");return this._controls}initialize(e){if(this._isDisposed)throw new Error("OrbitControlsPlugin has been disposed");this._context=e,this._controls=new ae.OrbitControls(e.camera,e.container),this._initialCameraPosition.copy(e.camera.position),this._controls.minDistance=this._initialMinDistance,this._controls.maxDistance=this._initialMaxDistance,this._controls.enableDamping=!0,this._controls.dampingFactor=.05,this._controls.enablePan=!0,this._controls.enableRotate=!0,this._controls.enableZoom=!0}configure(e){if(this._isDisposed)throw new Error("OrbitControlsPlugin has been disposed");if(!this._controls)throw new Error("OrbitControlsPlugin has not been initialized. Call initialize() first.");e.target!==void 0&&(this._controls.target.copy(e.target),this._initialTarget.copy(e.target)),e.minDistance!==void 0&&(this._controls.minDistance=e.minDistance,this._initialMinDistance=e.minDistance),e.maxDistance!==void 0&&(this._controls.maxDistance=e.maxDistance,this._initialMaxDistance=e.maxDistance),e.enableDamping!==void 0&&(this._controls.enableDamping=e.enableDamping),e.dampingFactor!==void 0&&(this._controls.dampingFactor=e.dampingFactor),e.enablePan!==void 0&&(this._controls.enablePan=e.enablePan),e.enableRotate!==void 0&&(this._controls.enableRotate=e.enableRotate),e.enableZoom!==void 0&&(this._controls.enableZoom=e.enableZoom),this._controls.update()}setTarget(e){if(this._isDisposed)throw new Error("OrbitControlsPlugin has been disposed");if(!this._controls)throw new Error("OrbitControlsPlugin has not been initialized. Call initialize() first.");this._controls.target.copy(e),this._initialTarget.copy(e),this._controls.update()}setZoomLimits(e,r){if(this._isDisposed)throw new Error("OrbitControlsPlugin has been disposed");if(!this._controls)throw new Error("OrbitControlsPlugin has not been initialized. Call initialize() first.");if(e>r)throw new Error("Minimum zoom distance cannot be greater than maximum zoom distance");if(e<0)throw new Error("Minimum zoom distance cannot be negative");this._controls.minDistance=e,this._controls.maxDistance=r,this._initialMinDistance=e,this._initialMaxDistance=r,this._controls.update()}reset(){if(this._isDisposed)throw new Error("OrbitControlsPlugin has been disposed");if(!this._controls||!this._context)throw new Error("OrbitControlsPlugin has not been initialized. Call initialize() first.");this._controls.target.copy(this._initialTarget),this._context.camera.position.copy(this._initialCameraPosition),this._controls.minDistance=this._initialMinDistance,this._controls.maxDistance=this._initialMaxDistance,this._controls.update()}update(e){this._isDisposed||!this._controls||this._controls.update()}dispose(){this._isDisposed||(this._controls&&(this._controls.dispose(),this._controls=null),this._context=null,this._isDisposed=!0)}}var B={exports:{}},F={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ie;function Me(){if(ie)return F;ie=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(s,i,c){var d=null;if(c!==void 0&&(d=""+c),i.key!==void 0&&(d=""+i.key),"key"in i){c={};for(var w in i)w!=="key"&&(c[w]=i[w])}else c=i;return i=c.ref,{$$typeof:n,type:s,key:d,ref:i!==void 0?i:null,props:c}}return F.Fragment=e,F.jsx=r,F.jsxs=r,F}var L={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var se;function ve(){return se||(se=1,process.env.NODE_ENV!=="production"&&(function(){function n(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===S?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case z:return"Fragment";case $:return"Profiler";case q:return"StrictMode";case U:return"Suspense";case u:return"SuspenseList";case E:return"Activity"}if(typeof t=="object")switch(typeof t.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),t.$$typeof){case C:return"Portal";case A:return t.displayName||"Context";case k:return(t._context.displayName||"Context")+".Consumer";case M:var o=t.render;return t=t.displayName,t||(t=o.displayName||o.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case _:return o=t.displayName||null,o!==null?o:n(t.type)||"Memo";case b:o=t._payload,t=t._init;try{return n(t(o))}catch{}}return null}function e(t){return""+t}function r(t){try{e(t);var o=!1}catch{o=!0}if(o){o=console;var h=o.error,p=typeof Symbol=="function"&&Symbol.toStringTag&&t[Symbol.toStringTag]||t.constructor.name||"Object";return h.call(o,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",p),e(t)}}function s(t){if(t===z)return"<>";if(typeof t=="object"&&t!==null&&t.$$typeof===b)return"<...>";try{var o=n(t);return o?"<"+o+">":"<...>"}catch{return"<...>"}}function i(){var t=v.A;return t===null?null:t.getOwner()}function c(){return Error("react-stack-top-frame")}function d(t){if(R.call(t,"key")){var o=Object.getOwnPropertyDescriptor(t,"key").get;if(o&&o.isReactWarning)return!1}return t.key!==void 0}function w(t,o){function h(){X||(X=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",o))}h.isReactWarning=!0,Object.defineProperty(t,"key",{get:h,configurable:!0})}function x(){var t=n(this.type);return Q[t]||(Q[t]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),t=this.props.ref,t!==void 0?t:null}function g(t,o,h,p,Y,G){var m=h.ref;return t={$$typeof:P,type:t,key:o,props:h,_owner:p},(m!==void 0?m:null)!==null?Object.defineProperty(t,"ref",{enumerable:!1,get:x}):Object.defineProperty(t,"ref",{enumerable:!1,value:null}),t._store={},Object.defineProperty(t._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(t,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(t,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:Y}),Object.defineProperty(t,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:G}),Object.freeze&&(Object.freeze(t.props),Object.freeze(t)),t}function T(t,o,h,p,Y,G){var m=o.children;if(m!==void 0)if(p)if(I(m)){for(p=0;p<m.length;p++)O(m[p]);Object.freeze&&Object.freeze(m)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else O(m);if(R.call(o,"key")){m=n(t);var V=Object.keys(o).filter(function(me){return me!=="key"});p=0<V.length?"{key: someKey, "+V.join(": ..., ")+": ...}":"{key: someKey}",te[m+p]||(V=0<V.length?"{"+V.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,p,m,V,m),te[m+p]=!0)}if(m=null,h!==void 0&&(r(h),m=""+h),d(o)&&(r(o.key),m=""+o.key),"key"in o){h={};for(var H in o)H!=="key"&&(h[H]=o[H])}else h=o;return m&&w(h,typeof t=="function"?t.displayName||t.name||"Unknown":t),g(t,m,h,i(),Y,G)}function O(t){D(t)?t._store&&(t._store.validated=1):typeof t=="object"&&t!==null&&t.$$typeof===b&&(t._payload.status==="fulfilled"?D(t._payload.value)&&t._payload.value._store&&(t._payload.value._store.validated=1):t._store&&(t._store.validated=1))}function D(t){return typeof t=="object"&&t!==null&&t.$$typeof===P}var y=l,P=Symbol.for("react.transitional.element"),C=Symbol.for("react.portal"),z=Symbol.for("react.fragment"),q=Symbol.for("react.strict_mode"),$=Symbol.for("react.profiler"),k=Symbol.for("react.consumer"),A=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),U=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),S=Symbol.for("react.client.reference"),v=y.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,R=Object.prototype.hasOwnProperty,I=Array.isArray,N=console.createTask?console.createTask:function(){return null};y={react_stack_bottom_frame:function(t){return t()}};var X,Q={},K=y.react_stack_bottom_frame.bind(y,c)(),ee=N(s(c)),te={};L.Fragment=z,L.jsx=function(t,o,h){var p=1e4>v.recentlyCreatedOwnerStacks++;return T(t,o,h,!1,p?Error("react-stack-top-frame"):K,p?N(s(t)):ee)},L.jsxs=function(t,o,h){var p=1e4>v.recentlyCreatedOwnerStacks++;return T(t,o,h,!0,p?Error("react-stack-top-frame"):K,p?N(s(t)):ee)}})()),L}var ne;function Re(){return ne||(ne=1,process.env.NODE_ENV==="production"?B.exports=Me():B.exports=ve()),B.exports}var Z=Re();const J=l.createContext(void 0);J.displayName="ThreeInstanceContext";const j={scene:null,camera:null,renderer:null,container:null,isReady:!1,isDisposed:!1},xe={unmounted:["mounted"],mounted:["initialized","disposed"],initialized:["disposed"],disposed:[]},Te={unmounted:!1,mounted:!1,initialized:!0,disposed:!1};function De(n,e){return xe[n].includes(e)}function ye(n,e){const r=Te[e];return e==="disposed"?{...j,isDisposed:!0}:!r||!n||!n.isInitialized?j:{scene:n.scene.scene,camera:n.camera.camera,renderer:n.renderer.renderer,container:n.container,isReady:!0,isDisposed:!1}}function fe({children:n,viewerCore:e}){const[r,s]=l.useState("unmounted"),i=l.useRef(!1),c=l.useRef(null),d=l.useCallback(g=>{s(T=>De(T,g)?g:T)},[]);l.useEffect(()=>(i.current=!0,d("mounted"),()=>{i.current=!1,s(g=>g!=="disposed"?"disposed":g)}),[d]),l.useEffect(()=>{const g=c.current;if(c.current=e,g&&!e){d("disposed");return}e&&e.isInitialized&&d("initialized")},[e,d]);const w=l.useCallback(()=>{e&&e.isInitialized&&r==="mounted"&&d("initialized")},[e,r,d]);l.useEffect(()=>{if(!e||r!=="mounted")return;w();const g=setInterval(w,50),T=setTimeout(()=>{clearInterval(g)},5e3);return()=>{clearInterval(g),clearTimeout(T)}},[e,r,w]);const x=l.useMemo(()=>ye(e,r),[e,r]);return Z.jsx(J.Provider,{value:x,children:n})}fe.displayName="ThreeInstanceProvider";const pe=l.forwardRef(function({modelUrl:e,pivotPoint:r,zoomLimits:s,className:i,style:c,onLoad:d,onError:w,onLoadingChange:x,children:g},T){const O=l.useRef(null),D=l.useRef(null),y=l.useRef(null),P=l.useRef(null),[C,z]=l.useState(!1),[q,$]=l.useState(null),k=l.useRef(d),A=l.useRef(w),M=l.useRef(x);l.useEffect(()=>{k.current=d},[d]),l.useEffect(()=>{A.current=w},[w]),l.useEffect(()=>{M.current=x},[x]),l.useImperativeHandle(T,()=>({getInstances(){if(C)return{...j,isDisposed:!0};const u=D.current;return!u||!u.isInitialized?j:{scene:u.scene.scene,camera:u.camera.camera,renderer:u.renderer.renderer,container:u.container,isReady:!0,isDisposed:!1}},getViewerCore(){return C?null:D.current},isReady(){if(C)return!1;const u=D.current;return u!==null&&u.isInitialized},isDisposed(){return C}}),[C]),l.useEffect(()=>{const u=O.current;if(!u)return;const _=new de;_.initialize({container:u,antialias:!0,alpha:!0});const b=new he,E=new _e;return _.plugins.register(b),_.plugins.register(E),D.current=_,y.current=b,P.current=E,$(_),z(!1),_.start(),()=>{_.dispose(),D.current=null,y.current=null,P.current=null,$(null),z(!0)}},[]),l.useEffect(()=>{const u=O.current,_=D.current;if(!u||!_)return;const b=new ResizeObserver(E=>{for(const S of E){const{width:v,height:R}=S.contentRect;v>0&&R>0&&_.resize(v,R)}});return b.observe(u),()=>{b.disconnect()}},[]),l.useEffect(()=>{var b;const u=y.current,_=P.current;if(u){if(!e){u.unload();return}(b=M.current)==null||b.call(M,!0),u.load(e).then(E=>{var S,v;if((S=M.current)==null||S.call(M,!1),_&&!r&&_.setTarget(E.center),_&&!s){const R=E.boundingBox,I=new f.Vector3;R.getSize(I);const N=Math.max(I.x,I.y,I.z);_.setZoomLimits(N*.1,N*10)}(v=k.current)==null||v.call(k,E)}).catch(E=>{var v,R;(v=M.current)==null||v.call(M,!1);const S=E instanceof Error?E:new Error(String(E));(R=A.current)==null||R.call(A,S)})}},[e]),l.useEffect(()=>{const u=P.current;if(u&&r){const _=new f.Vector3(r.x,r.y,r.z);u.setTarget(_)}},[r]),l.useEffect(()=>{const u=P.current;if(u&&s){const _=s.min??.1,b=s.max??1e3;u.setZoomLimits(_,b)}},[s]);const U={width:"100%",height:"100%",...c};return Z.jsxs(fe,{viewerCore:q,children:[Z.jsx("div",{ref:O,className:i,style:U}),g]})});pe.displayName="ThreeViewer";function Pe(){const n=l.useContext(J);if(n===void 0)throw new Error("useThreeInstance must be used within a ThreeViewer component. Make sure your component is a child of <ThreeViewer>.");return n}exports.CameraManager=le;exports.ModelLoaderPlugin=he;exports.OrbitControlsPlugin=_e;exports.PluginSystem=ue;exports.RenderManager=ce;exports.SceneManager=oe;exports.ThreeViewer=pe;exports.ViewerCore=de;exports.useThreeInstance=Pe;
//# sourceMappingURL=threejs-viewer.cjs.map
